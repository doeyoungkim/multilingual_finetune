[nltk_data] Downloading package punkt to /home/joel_jang/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
GPU available: True, used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/4
----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All distributed processes registered. Starting with 4 processes
----------------------------------------------------------------------------------------------------
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
  | Name  | Type                       | Params
-----------------------------------------------------
0 | model | T5ForConditionalGeneration | 2.8 B
-----------------------------------------------------
2.8 B     Trainable params
0         Non-trainable params
2.8 B     Total params
11,399.029Total estimated model params size (MB)
Validation sanity check: 0it [00:00, ?it/s]Length of dataset retrieving is.. 200
Validation sanity check:   0%|                                                         | 0/2 [00:00<?, ?it/s]
WARNING:datasets.builder:Found cached dataset cosmos_qa (/home/joel_jang/.cache/huggingface/datasets/cosmos_qa/default/0.1.0/3e18538cbfdb2c04189b16642715f0f6da3e97ed5df0aadcec3641245b2cf157)
100%|█████████████████████████████████████████████████████████████████████████| 3/3 [00:00<00:00, 471.45it/s]
WARNING:datasets.arrow_dataset:Loading cached shuffled indices for dataset at /home/joel_jang/.cache/huggingface/datasets/cosmos_qa/default/0.1.0/3e18538cbfdb2c04189b16642715f0f6da3e97ed5df0aadcec3641245b2cf157/cache-780ded7a9fe6758d.arrow
/home/joel_jang/miniconda3/envs/zeroshot/lib/python3.8/site-packages/pytorch_lightning/utilities/data.py:56: UserWarning: Trying to infer the `batch_size` from an ambiguous collection. The batch size we found is 4. To avoid any miscalculations, use `self.log(..., batch_size=batch_size)`.

Validation sanity check: 100%|█████████████████████████████████████████████████| 2/2 [00:06<00:00,  2.69s/it]agg_score is tensor(0.1562, device='cuda:0') 0
enter
###############################
{'id': '3Q9SPIIRWJKVQ8244310E8TUS6YWAC##34V1S5K3GTZMDUBNBIGY93FLDOB690##A1S1K7134S2VUC##Blog_1044056##q1_a1##3XU9MCX6VQQG7YPLCSAFDPQNH4GR20', 'context': "Good Old War and person L : I saw both of these bands Wednesday night , and they both blew me away . seriously . Good Old War is acoustic and makes me smile . I really can not help but be happy when I listen to them ; I think it 's the fact that they seemed so happy themselves when they played .", 'question': 'In the future , will this person go to see other bands play ?', 'answer0': 'None of the above choices .', 'answer1': 'This person likes music and likes to see the show , they will see other bands play .', 'answer2': 'This person only likes Good Old War and Person L , no other bands .', 'answer3': 'Other Bands is not on tour and this person can not see them .', 'label': 1}
###############################
Length of dataset retrieving is.. 25262
Epoch 0:   0%|                                                                      | 0/1592 [00:00<?, ?it/s]
WARNING:datasets.builder:Found cached dataset cosmos_qa (/home/joel_jang/.cache/huggingface/datasets/cosmos_qa/default/0.1.0/3e18538cbfdb2c04189b16642715f0f6da3e97ed5df0aadcec3641245b2cf157)









































































































































































































































































Epoch 0:  99%|█████████████████████████████████▋| 1579/1592 [09:00<00:04,  2.92it/s, loss=0.0616, v_num=pf3d]



enterating: 100%|████████████████████████████████████████████████████████████| 13/13 [00:12<00:00,  1.59it/s]
Epoch 0: 100%|█| 1592/1592 [09:13<00:00,  2.87it/s, loss=0.0616, v_num=pf3d, acc_score_cosmos_qa=0.790, acc_s
/home/joel_jang/miniconda3/envs/zeroshot/lib/python3.8/site-packages/pytorch_lightning/utilities/data.py:56: UserWarning: Trying to infer the `batch_size` from an ambiguous collection. The batch size we found is 2. To avoid any miscalculations, use `self.log(..., batch_size=batch_size)`.

Epoch 0: 100%|█| 1592/1592 [09:31<00:00,  2.79it/s, loss=0.0616, v_num=pf3d, acc_score_cosmos_qa=0.790, acc_ssave







































































































































































































































































Epoch 1:  99%|▉| 1579/1592 [08:55<00:04,  2.95it/s, loss=0.0475, v_num=pf3d, acc_score_cosmos_qa=0.790, acc_s




enterating: 100%|████████████████████████████████████████████████████████████| 13/13 [00:15<00:00,  1.35it/s]

Epoch 1: 100%|█| 1592/1592 [09:23<00:00,  2.83it/s, loss=0.0475, v_num=pf3d, acc_score_cosmos_qa=0.845, acc_ssave





































































































































































































































































Epoch 2:  99%|▉| 1579/1592 [08:58<00:04,  2.93it/s, loss=0.035, v_num=pf3d, acc_score_cosmos_qa=0.845, acc_sc



enterating: 100%|████████████████████████████████████████████████████████████| 13/13 [00:17<00:00,  1.23it/s]
Epoch 2: 100%|█| 1592/1592 [09:16<00:00,  2.86it/s, loss=0.035, v_num=pf3d, acc_score_cosmos_qa=0.855, acc_scsave








































































































































































































































































Epoch 3:  99%|▉| 1579/1592 [08:59<00:04,  2.93it/s, loss=0.0399, v_num=pf3d, acc_score_cosmos_qa=0.855, acc_s




enterating: 100%|████████████████████████████████████████████████████████████| 13/13 [00:19<00:00,  1.13it/s]

Epoch 3: 100%|█| 1592/1592 [09:18<00:00,  2.85it/s, loss=0.0399, v_num=pf3d, acc_score_cosmos_qa=0.885, acc_ssave








































































































































































































































































Epoch 4:  99%|▉| 1579/1592 [08:59<00:04,  2.93it/s, loss=0.0182, v_num=pf3d, acc_score_cosmos_qa=0.885, acc_s




enterating: 100%|████████████████████████████████████████████████████████████| 13/13 [00:18<00:00,  1.24it/s]
Epoch 4: 100%|█| 1592/1592 [09:18<00:00,  2.85it/s, loss=0.0182, v_num=pf3d, acc_score_cosmos_qa=0.880, acc_ssave
Epoch 4: 100%|█| 1592/1592 [10:03<00:00,  2.64it/s, loss=0.0182, v_num=pf3d, acc_score_cosmos_qa=0.880, acc_s
Time: 3120.4244034290314