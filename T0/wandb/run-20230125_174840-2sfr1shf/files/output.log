[nltk_data] Error loading punkt: <urlopen error [Errno 104] Connection
[nltk_data]     reset by peer>
/home/joel_jang/miniconda3/envs/zeroshot/lib/python3.8/site-packages/transformers/convert_slow_tokenizer.py:434: UserWarning: The sentencepiece tokenizer that you are converting to a fast tokenizer uses the byte fallback option which is not implemented in the fast tokenizers. In practice this means that the fast version of the tokenizer can produce unknown tokens whereas the sentencepiece version would have converted these unknown tokens into a sequence of byte tokens matching the original piece of text.
  warnings.warn(
GPU available: True, used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/15
----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All distributed processes registered. Starting with 15 processes
----------------------------------------------------------------------------------------------------
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3,4,5,6,7,8,9,11,12,13,14,15]
Validation sanity check: 0it [00:00, ?it/s]First elem of self.dataset is  {'document': 'Patrick Joseph Connors, 59, his son Patrick Dean Connors, 39, and nephew William Connors, 36, denied requiring a person to perform forced or compulsory labour between 2010 and 2013.\nThey were convicted by a jury at Cardiff Crown Court on Tuesday.\nConnors senior was jailed for 14 years, Patrick Dean for six-and-a-half years and William for four years.\nPatrick Joseph Connors\' son-in-law Lee Carbis, 34, who was cleared of forced labour, but found guilty of kidnap, was jailed for two-and-a-half years.\nCatrin Evans, of the Crown Prosecution Service in Wales, said the men were guilty of "exploiting and controlling" their vulnerable victim in a "callous manner over a prolonged period of time".\n\'Modern slavery\' victim \'emotionally broken\'\nThe Connors kept Michael Hughes, 46, in "appalling conditions" in south Wales and paid him less than £10 a day for years.\nHe said: "I am over the moon at today\'s verdict. Both myself and my family can now move on and I am so happy to have my life back - a life that I never knew existed.\n"Those people stole my life but the outcome of today\'s trial means that they will now face the justice that they deserve."\nJudge Neil Bidder QC said the three Connors, who operated a tarmacking business based at a farm in Rumney, treated their victims as little more than objects.\nHe said: "All the offences which you, Patrick Joseph Connors, have been convicted of are examples of conduct designed to keep two vulnerable men in what can only be described as modern-day slavery - in the case of Michael John Hughes, for 21 years.\n"By the end of that time he had been completely conditioned to being used by you as a serf."\nThe court heard over the course of the trial, Patrick Joseph Connors forced Mr Hughes to work for him for long hours, paying him tiny sums or just with alcohol and tobacco.\nMr Hughes was "hunted down" when he escaped and beaten "all the time", he said in evidence.\nHe was made to live in "appalling conditions", including in a 1.2m (4ft)-wide garden shed with no heating or running water for two years.\nThe court heard the only respite came when Mr Hughes was sent back to Scotland for unpaid fines and jailed. He said prison was "like a holiday camp" compared to his ordeal in Wales.\nConnors senior was also convicted of eight counts of assault occasioning actual bodily harm (ABH), four of kidnap and one charge of conspiracy to kidnap, while Patrick Dean Connors was also found guilty of kidnap.\nThe jury was told to return not guilty verdicts on a charge of conspiracy to kidnap against Patrick Dean Connors and another of assault against William Connors.\nGwent Police\'s Ch Supt Paul Griffiths, who led the investigation, said: "These types of crimes have a lasting effect on the victims - it is not just the physical degradation, it\'s psychological too. It causes deep and long-lasting trauma."', 'summary': 'Three family members have been jailed for forcing a man to do heavy labour for tiny amounts in Cardiff.', 'id': '36332024'}
Length of dataset retrieving is.. 1000
Validation sanity check:   0%|                                                  | 0/2 [00:00<?, ?it/s]
  | Name  | Type                        | Params
------------------------------------------------------
0 | model | MT5ForConditionalGeneration | 3.7 B
------------------------------------------------------
3.7 B     Trainable params
0         Non-trainable params
3.7 B     Total params
14,970.479Total estimated model params size (MB)
WARNING:datasets.builder:Found cached dataset xsum (/home/joel_jang/.cache/huggingface/datasets/xsum/default/1.2.0/082863bf4754ee058a5b6f6525d0cb2b18eadb62c7b370b095d1364050a52b71)
100%|██████████████████████████████████████████████████████████████████| 3/3 [00:00<00:00, 285.98it/s]
WARNING:datasets.arrow_dataset:Loading cached shuffled indices for dataset at /home/joel_jang/.cache/huggingface/datasets/xsum/default/1.2.0/082863bf4754ee058a5b6f6525d0cb2b18eadb62c7b370b095d1364050a52b71/cache-dd5e4180a7940dfa.arrow
/home/joel_jang/miniconda3/envs/zeroshot/lib/python3.8/site-packages/pytorch_lightning/trainer/data_loading.py:110: UserWarning: The dataloader, val_dataloader 0, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 96 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
  rank_zero_warn(
/home/joel_jang/miniconda3/envs/zeroshot/lib/python3.8/site-packages/pytorch_lightning/utilities/data.py:56: UserWarning: Trying to infer the `batch_size` from an ambiguous collection. The batch size we found is 1. To avoid any miscalculations, use `self.log(..., batch_size=batch_size)`.
Validation sanity check:   0%|                                                  | 0/2 [00:00<?, ?it/s]input: Patrick Joseph Connors, 59, his son Patrick Dean Connors, 39, and nephew William Connors, 36, denied requiring a person to perform forced or compulsory labour between 2010 and 2013. They were convicted by a jury at Cardiff Crown Court on Tuesday. Connors senior was jailed for 14 years, Patrick Dean for six-and-a-half years and William for four years. Patrick Joseph Connors' son-in-law Lee Carbis, 34, who was cleared of forced labour, but found guilty of kidnap, was jailed for two-and-a-half years. Catrin Evans, of the Crown Prosecution Service in Wales, said the men were guilty of "exploiting and controlling" their vulnerable victim in a "callous manner over a prolonged period of time". 'Modern slavery' victim 'emotionally broken' The Connors kept Michael Hughes, 46, in "appalling conditions" in south Wales and paid him less than £10 a day for years. He said: "I am over the moon at today's verdict. Both myself and my family can now move on and I am so happy to have my life back - a life that I never knew existed. "Those people stole my life but the outcome of today's trial means that they will now face the justice that they deserve." Judge Neil Bidder QC said the three Connors, who operated a tarmacking business based at a farm in Rumney, treated their victims as little more than objects. He said: "All the offences which you, Patrick Joseph Connors, have been convicted of are examples of conduct designed to keep two vulnerable men in what can only be described as modern-day slavery - in the case of Michael John Hughes, for 21 years. "By the end of that time he had been completely conditioned to being used by you as a serf." The court heard over the course of the trial, Patrick Joseph Connors forced Mr Hughes to work for him for long hours, paying him tiny sums or just with alcohol and tobacco. Mr Hughes was "hunted down" when he escaped and</s>
prediction: <extra_id_0> was "emotionally broken" by the trial. They were found guilty of kidnap, assault and murder. They were also found guilty of being involved in a scheme to kidnap a victim. The Crown Prosecution Service said: "I am very happy with today's verdict." Mr Hughes said: "I am very happy." The Crown Prosecution Service said: "I am very happy." <extra_id_1>. <extra_id_2>. <extra_id_3>. <extra_id_4>. <extra_id_5>. The Crown Prosecution Service said: "I am very happy." The
ground_truth Three family members have been jailed for forcing a man to do heavy labour for tiny amounts in Cardiff.
rouge score is 0.0634920594104311
Validation sanity check:  50%|█████████████████████                     | 1/2 [00:07<00:07,  7.08s/it]input: "After eight wonderful years on The X Factor it's time for me to move on," he said in a statement. "I'd like to thank ITV, Simon [Cowell], The X Factor family and particularly the viewers, all of whom have been a big part of my life for so long." The 41-year-old took over from Kate Thornton in 2007 as host of the popular talent show. The presenter and broadcaster currently presents a show on Radio 2 and recently completed a 24-hour dance challenge for Comic Relief. "I'd like to wish the team all the best for the future, especially whoever takes over from me," O'Leary continued. "You're about to be the conductor on the most brilliant, runaway train in showbiz. Good luck you'll love it!" The news of his departure may fuel speculation that O'Leary is a contender to replace Jeremy Clarkson on the BBC's Top Gear. Before Friday's announcement, William Hill had O'Leary as 6-1 to take over following the BBC's decision not to renew Clarkson's contract earlier this week. Before The X Factor, O'Leary hosted Big Brother's Little Brother, Channel 4's companion show to its long-running reality show. He has presented on BBC Radio 2 since 2004 and has hosted the National Television Awards since 2010. Bookmakers Ladbrokes have made singer Olly Murs, a former X Factor runner-up, favourite to take over the vacant presenting role. A spokesman for ITV said O'Leary had been "a fantastic host of The X Factor" and that the channel was "sorry to see him go". "We wish him all the very best for the future and hope that he'll be back on ITV screens soon." === Write a summary of the text above :</s><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad>
prediction: <extra_id_0> : : : : : : : : : : : : : : : : : : : : : : : : : :  <extra_id_1> : : : :  <extra_id_2> : : : : :  <extra_id_3> : : :  <extra_id_4> : : : : : :  <extra_id_5> : :  <extra_id_6> : : : : : :  <extra_id_7>  <extra_id_8> : :  <extra_id_9>
ground_truth Dermot O'Leary will no longer host ITV's The X Factor after eight years on the programme.
rouge score is 0.0
Validation sanity check: 100%|██████████████████████████████████████████| 2/2 [00:13<00:00,  6.61s/it]agg_score is tensor(0.0884, device='cuda:0') 0
enter
###############################
{'document': 'In Wales, councils are responsible for funding and overseeing schools.\nBut in England, Mr Osborne\'s plan will mean local authorities will cease to have a role in providing education.\nAcademies are directly funded by central government and head teachers have more freedom over admissions and to change the way the school works.\nIt is a significant development in the continued divergence of schools systems on either side of Offa\'s Dyke.\nAnd although the Welsh Government will get extra cash to match the money for English schools to extend the school day, it can spend it on any devolved policy area.\nMinisters have no plans to follow suit.\nAt the moment, governing bodies are responsible for setting school hours and they need ministerial permission to make significant changes.\nThere are already more than 2,000 secondary academies in England and its extension to all state schools is unlikely to shake the Welsh Government\'s attachment to what they call a "community, comprehensive model" for schools.\nIt rejects claims that freedom given to academies can help drive up standards, and it points to academy-free Scotland as the best performing school system in the UK.\nEducation Minister Huw Lewis said there was "very little evidence to suggest" academies have a positive impact in driving up standards and Wales would not be following the model.\n"The Tories have wasted hundreds of millions of pounds on academies and free schools and as the Chancellor finalises his budget plans to slash vital services even further, he is committing them to wasting even more on a failing endeavour.\n"We have no plans to introduce the chaos and waste of academies and free schools here in Wales."\nNone of the main parties in May\'s Assembly election - including the Welsh Conservatives - have said they want to introduce academies in Wales.\nOwen Hathway, NUT Cymru\'s policy officer, called the academy plans for England "scandalous.".\n"There is no evidence that academies work, no evidence that they raise standards, no evidence that they offer better quality education and no evidence that they are what parents and communities want," he said.\n"Certainly a commitment to comprehensive education is something we would want, and indeed expect, all parties to hold firm to in their manifestos for the forthcoming Welsh election."\nBut the Welsh and English schools systems are still linked by a joint arrangement for teachers\' pay and conditions.\nAcademies are not tied to these pay scales so in effect Wednesday\'s announcement will take all English schools out of the system and raise questions about the viability of an England and Wales pay and conditions structure.\nThere is already growing momentum for the devolution of teachers\' pay and conditions.\nOriginally sceptical, the Welsh Labour Government is now broadly in favour.\nSome teaching unions remain opposed because of concern that Welsh teachers would end up being paid less than those in England.\nMr Hathway said teachers were concerned it could lead to regional pay.\n"At the same time we do of course recognise that the issue of pay is already becoming a grey area due to the negative changes we see taking place in England," he said.\nBut an even bigger difference between the schools landscape on either side of the border, appears to make separate arrangements for pay increasingly likely in future.', 'summary': 'As Chancellor George Osborne announced all English state schools will become academies, the Welsh Government continues to reject the model here.', 'id': '35821725'}
###############################
First elem of self.dataset is  {'document': 'In Wales, councils are responsible for funding and overseeing schools.\nBut in England, Mr Osborne\'s plan will mean local authorities will cease to have a role in providing education.\nAcademies are directly funded by central government and head teachers have more freedom over admissions and to change the way the school works.\nIt is a significant development in the continued divergence of schools systems on either side of Offa\'s Dyke.\nAnd although the Welsh Government will get extra cash to match the money for English schools to extend the school day, it can spend it on any devolved policy area.\nMinisters have no plans to follow suit.\nAt the moment, governing bodies are responsible for setting school hours and they need ministerial permission to make significant changes.\nThere are already more than 2,000 secondary academies in England and its extension to all state schools is unlikely to shake the Welsh Government\'s attachment to what they call a "community, comprehensive model" for schools.\nIt rejects claims that freedom given to academies can help drive up standards, and it points to academy-free Scotland as the best performing school system in the UK.\nEducation Minister Huw Lewis said there was "very little evidence to suggest" academies have a positive impact in driving up standards and Wales would not be following the model.\n"The Tories have wasted hundreds of millions of pounds on academies and free schools and as the Chancellor finalises his budget plans to slash vital services even further, he is committing them to wasting even more on a failing endeavour.\n"We have no plans to introduce the chaos and waste of academies and free schools here in Wales."\nNone of the main parties in May\'s Assembly election - including the Welsh Conservatives - have said they want to introduce academies in Wales.\nOwen Hathway, NUT Cymru\'s policy officer, called the academy plans for England "scandalous.".\n"There is no evidence that academies work, no evidence that they raise standards, no evidence that they offer better quality education and no evidence that they are what parents and communities want," he said.\n"Certainly a commitment to comprehensive education is something we would want, and indeed expect, all parties to hold firm to in their manifestos for the forthcoming Welsh election."\nBut the Welsh and English schools systems are still linked by a joint arrangement for teachers\' pay and conditions.\nAcademies are not tied to these pay scales so in effect Wednesday\'s announcement will take all English schools out of the system and raise questions about the viability of an England and Wales pay and conditions structure.\nThere is already growing momentum for the devolution of teachers\' pay and conditions.\nOriginally sceptical, the Welsh Labour Government is now broadly in favour.\nSome teaching unions remain opposed because of concern that Welsh teachers would end up being paid less than those in England.\nMr Hathway said teachers were concerned it could lead to regional pay.\n"At the same time we do of course recognise that the issue of pay is already becoming a grey area due to the negative changes we see taking place in England," he said.\nBut an even bigger difference between the schools landscape on either side of the border, appears to make separate arrangements for pay increasingly likely in future.', 'summary': 'As Chancellor George Osborne announced all English state schools will become academies, the Welsh Government continues to reject the model here.', 'id': '35821725'}
Length of dataset retrieving is.. 100000
Training: 0it [00:00, ?it/s]
WARNING:datasets.builder:Found cached dataset xsum (/home/joel_jang/.cache/huggingface/datasets/xsum/default/1.2.0/082863bf4754ee058a5b6f6525d0cb2b18eadb62c7b370b095d1364050a52b71)
100%|██████████████████████████████████████████████████████████████████| 3/3 [00:00<00:00, 333.75it/s]
WARNING:datasets.arrow_dataset:Loading cached shuffled indices for dataset at /home/joel_jang/.cache/huggingface/datasets/xsum/default/1.2.0/082863bf4754ee058a5b6f6525d0cb2b18eadb62c7b370b095d1364050a52b71/cache-0179b5b9071d9bab.arrow
/home/joel_jang/miniconda3/envs/zeroshot/lib/python3.8/site-packages/pytorch_lightning/trainer/data_loading.py:110: UserWarning: The dataloader, train_dataloader, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 96 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.























Epoch 0:   1%|▏                            | 58/6734 [00:46<1:28:56,  1.25it/s, loss=2.52, v_num=1shf]Time: 247.2600736618042
/home/joel_jang/miniconda3/envs/zeroshot/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py:685: UserWarning: Detected KeyboardInterrupt, attempting graceful shutdown...
  rank_zero_warn("Detected KeyboardInterrupt, attempting graceful shutdown...")